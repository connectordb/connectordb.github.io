<!DOCTYPE html>
<html>

	{% include /head.html %}

	<body id="top">

		{% include /header.html %}

		<!-- Banner -->
		<section id="banner">
			<div class="inner">
				<h2>ConnectorDB</h2>
				<p>An Open-Source Quantified Self & IoT Database</p>
				<ul class="actions">
					<li><a href="download.html" class="button big special">Download</a></li>
					<li><a href="#one" class="button big alt page-scroll">Learn More</a></li>
				</ul>
                <p><b>Note:</b> ConnectorDB will be released on May 22!</p>
			</div>
		</section>
		{{ content }} {% include /footer.html %}

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.3/jquery.easing.min.js"></script>
        <script type="text/javascript">


			//jQuery for page scrolling feature - requires jQuery Easing plugin
			$(function() {
				$('a.page-scroll').bind('click', function(event) {
					var $anchor = $(this);
					$('html, body').stop().animate({
						scrollTop: $($anchor.attr('href')).offset().top
					}, 1500, 'easeInOutExpo');
					event.preventDefault();
				});
			});

		</script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/codemirror.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/mode/javascript/javascript.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.11.0/addon/edit/matchbrackets.min.js"></script>
        <script>
            var input = CodeMirror.fromTextArea(document.getElementById("input"), {
                matchBrackets: true,
                autoCloseBrackets: true,
                mode: "application/json",
                lineWrapping: true
            });
            var output = CodeMirror.fromTextArea(document.getElementById("output"), {
                matchBrackets: true,
                autoCloseBrackets: true,
                mode: "application/json",
                lineWrapping: true,
                readOnly: true
            });

            input.setValue(JSON.stringify(JSON.parse(
				'[{"t": 145417065,"d": {"steps": 14,"activity": "walking"}},\
			{"t": 145511065,"d": { "steps": 10,"activity": "running"}},\
			{"t": 145513065,"d": {"steps": 12,"activity": "walking"}},\
			{"t": 145517065,"d": {"steps": 5,"activity": "running"}}]'), null, 2));

            output.setValue("Loading PipeScript...");

        </script>

		<script>
			// Load PipeScript asynchronously
			$.getScript("/pipescript/pipescript.js",function(data, status, jqxhr) {
				console.log("Loaded PipeScript")
				runScript();
			}).fail(function(jqxhr, settings, exception) {
				console.log("Exception while loading PipeScript: "+ exception)
				runScript();
			}

			)
			function runScript() {
				output.setValue("Running...");
				s = pipescript.Script($("#script").val());
				if (!s.IsValid()) {
					output.setValue(s.Error());
				}
				result = s.Run(input.getValue());
				if (!s.IsValid()) {
					output.setValue(s.Error()+"\n"+ result);
				} else {
					output.setValue(result);
				}
			}

			$("#scriptbtn").click(function(e) {
				e.preventDefault();
				runScript();
			});
        </script>
	</body>

</html>
